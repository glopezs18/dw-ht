const express=require("express"),mongoose=require("mongoose"),{loginModel:loginModel}=require("./models.js"),jwt=require("jsonwebtoken");var login=express.Router();login.use(express.json()),mongoose.connect("mongodb://127.0.0.1:27017/ht7"),login.get("/",(req,res)=>{res.json({message:"Nodejs, JWT and MongoDB"})}),login.post("/:dpi",(function(req,res){const user={nombre:req.body.usuario,clave:req.body.clave,dpi:req.params.dpi};loginModel.create(user).then(()=>{jwt.sign({user:user},"secretkey",(err,token)=>{res.json({token:token})})}).catch(err=>res.json(err))})),module.exports=login;